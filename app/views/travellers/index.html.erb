<%# greeting banner %>
<%= render "shared/dashboardheader", locales: {:user => @user} %>
<% if @user.guide %>
	<a href="/guides" class="btn btn-outline-secondary btn-sm mb-5">Guide's dashboard</a>
<% else %>
	<a href="/travellers/becomeaguide" class="btn btn-outline-secondary btn-sm mb-5">Become a guide and showcase your city!</a>
<% end %>
<%# dashboard main %>
<a class = "btn btn-block btn-success mb-5" href="/travellers/findguide">Going on an adventure!</a>
<%# visible only on xs %>
<div class="d-block d-sm-none">
	<ul class="nav nav-tabs nav-fill" id="myTab" role="tablist">
	  <li class="nav-item">
	    <a class="nav-link active" id="conversations-tab" data-toggle="tab" href="#conversations" role="tab">Messages</a>
	  </li>
	  <li class="nav-item">
	    <a class="nav-link" id="reviews-tab" data-toggle="tab" href="#reviews" role="tab">Reviews</a>
	  </li>
	</ul>
	<div class="tab-content mb-5" id="myTabContent">
<%# conversations tab %>
	  <div class="mt-3 tab-pane fade show active" id="conversations" role="tabpanel">
	  	<% @conversations.each do |conversation| %>
  			<% if conversation.sender_id == current_user.id || conversation.recipient_id == current_user.id %>
  				<% if conversation.sender_id == current_user.id %>
  					<% recipient = User.find(conversation.recipient_id) %>
  				<% else %>
  					<% recipient = User.find(conversation.sender_id) %>
  				<% end %>
  				<div class="alert alert-secondary d-flex justify-content-between" role="alert">
  					<%= link_to recipient.name, conversation_messages_path(conversation), :class => "text-dark"%>
            <a href="/guides/<%=recipient.id%>/reviews/new">Leave A Review</a>
  				</div>
  			<% end %>
  		<% end %>
	  </div>
<%# reviews tab %>
	  <div class="tab-pane fade text-center" id="reviews" role="tabpanel">
	  	<h1 class="display-4">No reviews yet</h1>
	  </div>
	</div>
</div>
<%# hidden only on xs %>
<div class="container d-none d-sm-block">
	<div class="row">
<%# conversations column %>
		<div class="col-6 pl-0">
			<div class="card">
		  	<h5 class="card-header">Conversations</h5>
				<div class="card-body">
					<% @conversations.each do |conversation| %>
						<% if conversation.sender_id == current_user.id || conversation.recipient_id == current_user.id %>
							<% if conversation.sender_id == current_user.id %>
								<% recipient = User.find(conversation.recipient_id) %>
							<% else %>
								<% recipient = User.find(conversation.sender_id) %>
							<% end %>
							<span class="card-title d-flex justify-content-between">
								<%= link_to recipient.name, conversation_messages_path(conversation), :class => "text-dark lead mt-2"%>
								<a class="btn btn-outline-secondary btn-sm" href="/guides/<%=recipient.id%>/reviews/new">Leave a review</a>
							</span>
							<hr>
						<% end %>
					<% end %>
				</div>
			</div>
		</div>
<%# reviews column %>
		<div class="col-6 pr-0">
			<div class="card">
	  		<h5 class="card-header">Reviews</h5>
				<div class="card-body">
					<h4>No reviews yet</h4>
				</div>
			</div>
		</div>
	</div>
</div>